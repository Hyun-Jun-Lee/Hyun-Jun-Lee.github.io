---
title:  "프로세스와 스레드"
excerpt: "Operating System"

categories:
- CS

toc: True
toc_sticky: True

date: 2022-01-14
last_modified_at: 2022-01-14
---

# 프로세스와 스레드

- 프로세스 : 메모리에 적재되고 CPU 자원을 할당받아 프로그램이 실행되고 있는 상태

- 스레드 : 프로세스 안에서 실행되는 여러 흐름 단위

![image](https://user-images.githubusercontent.com/76996686/149650346-b6827ae3-5059-45a4-99d2-c6f346a6bd67.png)

프로세스는 각각 별도의 주소 공간을 할당한다.

스레드는 Stack만 할당 받고 나머지 영역은 서로 공유한다.

하나의 프로세스가 생성 될 때, 기본적을 하나의 스레드가 같이 생성됨

프로세스는 자신만의 고유 공간과 자원을 할당 받아 사용함
스레드는 다른 스레드와 공간, 자원을 공유

> OS가 프로그램을 실행하는 구조

컴퓨터에 설치된 프로그램은 하드디스크안에 있으나 OS가 이를 실행할 때는 메모리로 읽어들인 후에 실행시킴.

프로세스가 CPU에 할당되어 처리 중인 상태를 '실행 상태'라고 함.

## 프로세스의 메모리 영역

![image](https://user-images.githubusercontent.com/76996686/149650508-b8dc6928-b84c-4413-95bb-3a403927d664.png)

- Text(code) 영역
  - 프로그램 명령이 위치하는 곳으로 기계어로 제어되는 메모리 영역
  - 우리가 작성한 소스코드가 들어가는 부분으로, 코드가 저장되는 영역이라고 해서 Code 영역이라고도 부름
  - 중간에 코드를 바꿀 수 없게 Read-only로 지정 돼있다.


- Data 영역
  - '프로그램의 초기값이 있는' 전역 변수, 배열, 정적 변수가 저장되는 영역으로 '프로그램이 구동되는 동안 항상 접근 가능한 변수가 저장되는 영역'이다.
  - Data 영역은 프로그램의 시작과 함께 할당되며, 프로그램이 종료되면 소멸
  - 실행 중간에 전역 변수가 변경 될 수도 있기 때문에, 이 영역은 Read-Write로 지정되있다.

- BSS
  - '초기 값이 없는' 전역 변수, 배열, 정적 변수가 저장되는 영역
  - 초기화 된 데이터는 Data 영역, 초기화 되지 않은 데이터는 BSS 영역에 저장된다.

- Heap 
  - 동적 메모리 할당을 위한 영역, 런타임에 크기가 결정되는 메모리 영역이다.
  - 사용자에 의해 메모리 공간이 동적으로 할당되고 해제 됨.
  - Heap과 Stack은 같은 공간을 점유 하는데 각 영역이 상대 공간을 침범하게 되면 Heap overflow, Stack overflow라고 부른다.

- Stack
  - 지역/매개변수, 리턴 값 등이 잠시 사용되었다가 사라지는 데이터를 저장하는 영역
  - 함수의 호출과 관계되는 지역 변수와 매개변수가 저장되는 영역이다.
  - LIFO 특성

> Data/BSS 영역을 구분하는 이유

초기화되지 않은 변수는 프로그램이 실행될 때 영역만 잡아주면 되고 그 값을 프로그램에 저장하고 있을 필요는 없으나 초기화가 되는 변수는 그 값도 프로그램에 저장하고 있어야 하기 때문이다. 따라서 bss 영역 변수들이 많아져도 프로그램의 실행코드 사이즈를 늘리지 않는다.

## 멀티 프로세스

하나의 컴퓨터에 여러 CPU를 장착해서 하나 이상의 프로세스들이 동시에 병렬 처리한다.

안정적이지만, 각각 독립된 메모리 영역을 가지고 있어서 작업량이 많을 수록 오버헤드 발생 and Context Switching으로 인한 성능 저하

- Context Switching
  - 프로세스의 상태 정보를 저장하고 복원하는 일련의 과정
  - 동작 중인 프로세스가 대기하면서 해당 프로세스의 상태를 보관하고, 대기하고 있던 다음 순번의 프로세스가 동작 하면서 이전에 보관했던 프로세스 상태를 복구하는 과정

## 멀티 스레드

하나의 응용 프로그램에서 여러 스레드를 구성해 각 스레드가 하나의 작업을 처리하는 것
공유 메모리를 통해 다수의 작업을 동시에 처리하도록 해준다.

- 장점 : 독립적인 프로세스에 비해 메모리를 공유하기 때문에 시간, 자원 손실이 감소/전역 변수와 정적 변수에 대한 자료 공유 가능
- 단점 : 안전성 문제, 하나의 스레드가 데이터 공간을 망가뜨리면 모든 스레드가 작동 불능 상태가 된다(공유 메모리를 가지기 때문)



